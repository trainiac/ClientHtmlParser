{"version":3,"sources":["../../server/app.js"],"names":["app","settings","config","loggerLevel","faviconFile","join","serveStaticPath","console","log","use","json","urlencoded","extended","clientBuildPath","clientSrcPath","staticPublicPath","static","htmlFile","req","res","sendFile"],"mappings":";;;;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;AACA;;;;;;kBAGe,CAACA,GAAD,EAAMC,QAAN,KAAmB;AAAA,QAExBC,MAFwB,GAEAD,QAFA,CAExBC,MAFwB;AAAA,QAEhBC,WAFgB,GAEAF,QAFA,CAEhBE,WAFgB;;AAGhC,QAAMC,cAAc,eAAKC,IAAL,CAAUH,OAAOI,eAAjB,EAAkC,aAAlC,CAApB;;AAEAC,UAAQC,GAAR,CAAa,wBAAsBJ,WAAY,GAA/C;AACAJ,MAAIS,GAAJ,CAAQ,4BAAQL,WAAR,CAAR;;AAEAG,UAAQC,GAAR,CAAa,uBAAqBL,WAAY,GAA9C;AACAH,MAAIS,GAAJ,CAAQ,sBAAON,WAAP,CAAR;;AAEAI,UAAQC,GAAR,CAAY,wBAAZ;AACAR,MAAIS,GAAJ,CAAQ,qBAAWC,IAAX,EAAR;AACAV,MAAIS,GAAJ,CACE,qBAAWE,UAAX,CAAsB;AACpBC,cAAU;AADU,GAAtB,CADF;;AAMAL,UAAQC,GAAR,CAAY,0BAAZ;AACAR,MAAIS,GAAJ,CAAQ,6BAAR;;AAEAF,UAAQC,GAAR,CAAY,2BAAZ;AACAD,UAAQC,GAAR,CAAa,uBAAqBN,OAAOW,eAAgB,GAAzD;AACAN,UAAQC,GAAR,CAAa,qBAAmBN,OAAOY,aAAc,GAArD;AACAP,UAAQC,GAAR,CAAa,wBAAsBN,OAAOa,gBAAiB,GAA3D;AACAf,MAAIS,GAAJ,CACEP,OAAOa,gBADT,EAEE,kBAAQC,MAAR,CAAed,OAAOW,eAAtB,CAFF;AAIA;;AAEA,QAAMI,WAAW,eAAKZ,IAAL,CAAUH,OAAOI,eAAjB,EAAkC,YAAlC,CAAjB;;AAEAC,UAAQC,GAAR,CAAa,oCAAkCS,QAAS,GAAxD;AACAjB,MAAIS,GAAJ,CAAQ,CAACS,GAAD,EAAMC,GAAN,KAAc;;AAEpBA,QAAIC,QAAJ,CAAaH,QAAb;AAED,GAJD;;AAMAV,UAAQC,GAAR,CAAY,0BAAZ;AACAR,MAAIS,GAAJ,CAAQ,OAAR;;AAEAF,UAAQC,GAAR,CAAY,4BAAZ;AACAR,MAAIS,GAAJ,CAAQ,qBAAiBT,GAAjB,CAAR;;AAEA,SAAOA,GAAP;AAED,C","file":"app.js","sourcesContent":["import express from 'express'\nimport bodyParser from 'body-parser'\nimport cookieParser from 'cookie-parser'\nimport favicon from 'serve-favicon'\nimport logger from 'morgan'\nimport path from 'path'\n\nimport apiRoutes from './routes/api'\nimport getErrorHandlers from './routes/error'\n\n\nexport default (app, settings) => {\n\n  const { config, loggerLevel } = settings\n  const faviconFile = path.join(config.serveStaticPath, 'favicon.ico')\n\n  console.log(`configuring favicon ${faviconFile}`)\n  app.use(favicon(faviconFile))\n\n  console.log(`configuring logger ${loggerLevel}`)\n  app.use(logger(loggerLevel))\n\n  console.log('configuring bodyParser')\n  app.use(bodyParser.json())\n  app.use(\n    bodyParser.urlencoded({\n      extended: false\n    })\n  )\n\n  console.log('configuring cookieParser')\n  app.use(cookieParser())\n\n  console.log('configuring static routes')\n  console.log(`config: build path ${config.clientBuildPath}`)\n  console.log(`config: src path ${config.clientSrcPath}`)\n  console.log(`config: public path ${config.staticPublicPath}`)\n  app.use(\n    config.staticPublicPath,\n    express.static(config.clientBuildPath)\n  )\n  // the public path is defined in webpack.config.js\n\n  const htmlFile = path.join(config.serveStaticPath, 'index.html')\n\n  console.log(`configuring html wildcard route ${htmlFile}`)\n  app.use((req, res) => {\n\n    res.sendFile(htmlFile)\n\n  })\n\n  console.log('configuring api handlers')\n  app.use('/api/', apiRoutes)\n\n  console.log('configuring error handlers')\n  app.use(getErrorHandlers(app))\n\n  return app\n\n}\n\n"]}