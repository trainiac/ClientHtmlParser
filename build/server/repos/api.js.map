{"version":3,"sources":["../../../server/repos/api.js"],"names":["apiHost","getUrl","curry","protocol","host","path","query","format","getAPIEndpoint","Reflect","apply","undefined","split","getSpecificAPIEndpoint","callApi","endpoint","then","response","json","ok","Error","actionToObjects","flow","q"],"mappings":";;;;;;;AAAA;;;;AACA;;;;AACA;;;;;;AAGA;;;AAGA,MAAMA,UAAU,iBAAhB;AACA,MAAMC,SAAS,aAAGC,KAAH,CAAS,CAACC,QAAD,EAAWC,IAAX,EAAiBC,IAAjB,EAAuBC,KAAvB,KAAiC,cAAIC,MAAJ,CAAW;AAClEJ,oBADkE,EACxDC,UADwD,EAClDC,UADkD,EAC5CC;AAD4C,CAAX,CAA1C,CAAf;AAGA,MAAME,iBAAiBC,QAAQC,KAAR,CAAcT,MAAd,EAAsBU,SAAtB,EAAiCX,QAAQY,KAAR,CAAc,KAAd,CAAjC,CAAvB;AACA,MAAMC,yBAAyBL,eAAe,SAAf,CAA/B;;AAEA,SAASM,OAAT,CAAiBC,QAAjB,EAA2B;;AAEzB,SAAO,yBAAMA,QAAN,EAAgBC,IAAhB,CAAqBC,YACxBA,SAASC,IAAT,GAAgBF,IAAhB,CAAqBE,SAAS,EAAEA,UAAF,EAAQD,kBAAR,EAAT,CAArB,CADG,EAEHD,IAFG,CAEE,UAAwB;AAAA,QAArBE,IAAqB,QAArBA,IAAqB;AAAA,QAAfD,QAAe,QAAfA,QAAe;;;AAE7B,QAAI,CAACA,SAASE,EAAd,EAAkB;;AAEhB,YAAM,IAAIC,KAAJ,CAAW,IAAEF,IAAK,MAAGD,QAAS,GAA9B,CAAN;AAED;;AAED,WAAO;AACLA,wBADK;AAELC;AAFK,KAAP;AAKD,GAfI,CAAP;AAiBD;;AAEM,MAAMG,4CAAkB,aAAGC,IAAH,CAC7BhB,UAAU,EAAEiB,GAAGjB,KAAL,EAAV,CAD6B,CACJ;;AADI,EAG7BO,sBAH6B,EAI7BC,OAJ6B,CAAxB","file":"api.js","sourcesContent":["import fetch from 'node-fetch'\nimport fp from 'lodash/fp'\nimport url from 'url'\n\n\n/*\n  Functions that handle building API URLs\n*/\nconst apiHost = 'https://api.com'\nconst getUrl = fp.curry((protocol, host, path, query) => url.format({\n  protocol, host, path, query\n}))\nconst getAPIEndpoint = Reflect.apply(getUrl, undefined, apiHost.split('://'))\nconst getSpecificAPIEndpoint = getAPIEndpoint('/action')\n\nfunction callApi(endpoint) {\n\n  return fetch(endpoint).then(response =>\n      response.json().then(json => ({ json, response }))\n    ).then(({ json, response }) => {\n\n      if (!response.ok) {\n\n        throw new Error(`${json} ${response}`)\n\n      }\n\n      return {\n        response,\n        json\n      }\n\n    })\n\n}\n\nexport const actionToObjects = fp.flow(\n  query => ({ q: query })  // eslint-disable-line id-length\n,\n  getSpecificAPIEndpoint,\n  callApi\n)\n"]}